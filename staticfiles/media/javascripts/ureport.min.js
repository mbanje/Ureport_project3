function remove_selection(){$("#map_legend").hide();$(".module ul li img").each(function(){$(this).removeClass("selected")});$("#visual").children().each(function(){$(this).empty();$(this).hide()})}function ajax_loading(a){var b=$(a),c=b.offset(),a=c.left,c=c.top,e=b.outerWidth(),b=b.outerHeight();$('<div class="ajax_loading"></div>').css({position:"absolute",left:a+"px",top:c+"px",width:e+"px",height:b+"px"}).appendTo(document.body).show()}
var bar_opts={chart:{renderTo:"bar",defaultSeriesType:"column"},title:{text:""},subtitle:{text:""},xAxis:{categories:[]},yAxis:{min:0,title:{text:"Count"}},legend:!1,credits:!1,tooltip:{formatter:function(){return""+this.x+": "+this.y}},plotOptions:{column:{pointPadding:0.2,borderWidth:0}},series:[{data:[]}]};function weighted_average(a){total_count=weighted_sum=0;$.each(a,function(a,c){weighted_sum+=c[1]*c[0];total_count+=c[1]});return weighted_sum/total_count}
function std_dev(a){average=weighted_average(a);total_count=variance=0;$.each(a,function(a,c){variance+=Math.pow(c[0]-average,2)*c[1];total_count+=c[1]});return Math.sqrt(variance/total_count)}function clean_data(a){sd=std_dev(a);mean=weighted_average(a);max=mean+3*sd;min=mean-3*sd;_clean_data=[];$.each(a,function(a,c){c[0]>min&&c[0]<max&&_clean_data.push(c)});return _clean_data}
function make_hist_plottable(a,b,c){a=a.reverse();max=Math.ceil(a[0][0]);min=Math.floor(a[a.length-1][0]);num_bars=a.length;$.each(a,function(a,d){b.push(Math.round(d[1]));c.push(Math.round(d[0]))})}
function plot_histogram(a,b){num_bars=6;bar_data=[];categories=[];if(a.length<=num_bars)make_hist_plottable(a,bar_data,categories);else{a=clean_data(a);if(a.length<=num_bars)make_hist_plottable(a,bar_data,categories);else{max=Math.ceil(a[0][0]);for(min=Math.floor(a[a.length-1][0]);0!=(max-min)%num_bars&&0<=min;)min--;for(;0!=(max-min)%num_bars;)max++;increment=(max-min)/num_bars;offset=a.length-1;for(i=min;i<max;i+=increment){category=""+i+"-"+(i+increment);count=0;categories[categories.length]=category;
for(i+increment==max&&(increment+=1);-1<offset&&a[offset][0]>=i&&a[offset][0]<i+increment;)count+=a[offset][1],offset-=1;bar_data[bar_data.length]=count}}bar_opts.series[0].data=bar_data;bar_opts.xAxis.categories=categories;bar_opts.chart.renderTo=b;new Highcharts.Chart(bar_opts)}}function load_histogram(a,b,c){remove_selection();$("#"+b).show();$("img.bar"+b).addClass("selected");$.ajax({type:"GET",url:c,dataType:"json",success:function(a){plot_histogram(a,b)}})}
var pie_opts={chart:{renderTo:"pie",margin:[5,5,5,5]},title:{text:""},plotArea:{shadow:!0,borderWidth:30,backgroundColor:null},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+this.y.toFixed(1)+" %"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,formatter:function(){return"uncategorized"==this.point.name?"N/A":this.y.toFixed(1) + ' %'},color:"white",style:{font:"13px Trebuchet MS, Verdana, sans-serif"}}}},legend:{layout:"horizontal",style:{left:"auto",bottom:"auto",
right:"10px",top:"525px"}},credits:!1,subtitle:{text:""},series:[{type:"pie",name:"",data:[]}]};
function plot_piechart(a,b){if(!(1>a.length)){pie_opts.chart.renderTo=b;plot_data=[];plot_colors=[];for(i=total=0;i<a.length;i++)plot_data[plot_data.length]=[a[i].category__name,a[i].value],plot_colors[plot_colors.length]=get_color(a[i].category__name),total+=plot_data[plot_data.length-1][1];for(i=0;i<plot_data.length;i++)plot_data[i][1]=100*plot_data[i][1]/total;pie_opts.colors=plot_colors;pie_opts.series[0].data=plot_data;pie_opts.series[0].data[0]={name:plot_data[0][0],y:plot_data[0][1],sliced:!0,
selected:!0};new Highcharts.Chart(pie_opts)}}function load_piechart(a,b,c){remove_selection();$("#"+b).show();$("img.pie"+a).addClass("selected");$.ajax({type:"GET",url:c,dataType:"json",success:function(a){$(".ajax_loading").remove();plot_piechart(a.data,b)}})}function load_tag_cloud(a){remove_selection();$("#tags").show();$("#tags").load(a,function(){$(".ajax_loading").remove()})}function add_tag(a,b){$.ajax({type:"GET",url:a,dataType:"json",success:function(){load_tag_cloud(b)}})}
function remove_tag(a,b){$.ajax({type:"GET",url:a,dataType:"json",success:function(){load_excluded_tags(b)}})}function load_excluded_tags(a){$("#tagcontent").hide();$("#excluded").load(a);$("#excluded").show()}function load_timeseries(a,b){remove_selection();$("#poll_timeseries").show();$("img.series"+b).addClass("selected");$("#poll_timeseries").load(a)}function load_responses(a){remove_selection();$("#poll_responses").show();$("#poll_responses").load(a,function(){$(".ajax_loading").remove()})}
function load_report(a,b){remove_selection();$("#poll_report").show();$("#poll_report").load(b,function(){$(".ajax_loading").remove()})}function collapse(){$("#show_results_list").show();$("#object_list").hide()}function expand(){$("#show_results_list").hide();$("#object_list").show()}function deleteReporter(a,b,c){confirm("Are you sure you want to remove "+c+"?")&&($(a).parents("tr").remove(),$.post("../reporter/"+b+"/delete/",function(){}))}
function editReporter(a,b){overlay_loading_panel($(a).parents("tr"));$(a).parents("tr").load("../reporter/"+b+"/edit/","",function(){$("#div_panel_loading").hide()})}function toggleReplyBox(a,b,c){a.innerHTML="- send message -"==a.text?"- hide message box -":"- send message -";a=document.getElementById("replyForm_"+c);$(a).append($("#formcontent"));$("#formcontent").show();$(a).slideToggle(300);$("#id_recipient").val(b);$("#id_in_response_to").val(c)}
function submitForm(a,b,c){form=$(a).parents("form");form_data=form.serializeArray();c.load(b,form_data)}function filter(a){ajax_loading(a);form=$(a).parents("form");form_data=form.serializeArray();$("#div_results_loading").show();$("#object_list").load("./",form_data,function(){$("#div_results_loading").hide();$(".ajax_loading").remove()})}
function overlay_loading_panel(a){var b=a.offset(),c=$("#div_panel_loading").parent().offset();$("#div_panel_loading").css({left:b.left-c.left+"px",top:b.top-c.top+"px",width:a.outerWidth()+"px",height:a.outerHeight()+"px"});$("#div_panel_loading").show()}function page(a,b){$("#input_page_num").val(b);$("#input_page_action").val("true");filter(a)}function sort(a,b,c){$("#input_sort_column").val(b);$("#input_sort_action").val("true");$("#input_sort_ascending").val(c);filter(a)}
function action(a,b,c){if(!$(a).is(".delete")||confirm("Are you sure?"))$("#input_action").val(b),form=$(a).parents("form"),form_data=form.serializeArray(),form_data.concat([{page_num:c}]),ajax_loading(a),$("#object_list").load("./",form_data,function(){$(".ajax_loading").remove();$(form).find('textarea,input[type="text"],input[type="file"]').val("");})}
function actionx(a,b,c){if(!$(a).is(".delete")||confirm("Are you sure?"))$("#input_action").val(b),form=$(a).parents("form"),form_data=form.serializeArray(),form_data.concat([{page_num:c}]),ajax_loading(a),$("#object_list").load("./",form_data,function(){$(".ajax_loading").remove();$(form).find('textarea,input[type="text"],input[type="file"]').val("");})}
function select_all(){$("#input_select_all").attr("checked")?($("#span_select_everything").show(),$("input:checkbox[name=results]").attr("checked","checked")):($("#span_select_everything").hide(),$("input:checkbox[name=results]").attr("checked",!1))}function deselect_all(){$("#input_select_all").attr("checked",!1);$("#span_select_everything").hide()}
function select_everything(a){$("#input_select_everything").val("true");$("#span_select_everything").html("All "+a+' items are selected. <a href="javascript:void(0)" onclick="deselect_everything('+a+')">Clear selection</a>')}
function deselect_everything(a){$("#input_select_everything").val("");$("#span_select_everything").html('You have selected all items on this page.  <a href="javascript:void(0)" onclick="select_everything('+a+')">Click here</a> to select all '+a+" items.");$("#input_select_all").attr("checked",!1);select_all()}
function disable_enter(){$.browser.mozilla?($("#filters input:text").keypress(function(a){if(13==a.keyCode)return!1}),$("#actions input:text").keypress(function(a){if(13==a.keyCode)return!1})):($("#filters input:text").keydown(function(a){if(13==a.keyCode)return!1}),$("#actions input:text").keydown(function(a){if(13==a.keyCode)return!1}))}function highlight(a){$(a).parent().addClass("active")}
$(document).ready(function(){0<$("#accordion").length&&$(function(){$("#accordion").accordion({autoHeight:!1,collapsible:!0})});$(function(){$(".replyForm").hide()})});